package routers

import (
	"strings"

	"cve-sa-backend/iniconf"
	"cve-sa-backend/utils/tools"

	"github.com/gin-gonic/gin"
)

func managerAuth(c *gin.Context) {
	username := strings.TrimSpace(c.PostForm("username"))
	password := strings.TrimSpace(c.PostForm("password"))
	if username != iniconf.Upload.Username || password != iniconf.Upload.Password {
		c.Abort()
		tools.Failure(c, "Username or password error")
		return
	}
	c.Next()
}
